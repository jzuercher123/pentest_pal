import anthropic
import requests

# Initialize the Anthropic client
client = anthropic.Anthropic(api_key='YOUR_API_KEY')

def analyze_code(code_snippet):
    prompt = f"Analyze the following code for security vulnerabilities:\n\n{code_snippet}\n\nProvide a detailed report of any potential issues found."
    response = client.completions.create(
        model="claude-2.1",
        prompt=f"Human: You are a cybersecurity expert specializing in code analysis. {prompt}\n\nAssistant:",
        max_tokens_to_sample=500,
        temperature=0
    )
    return response.completion

def generate_test_inputs(vulnerability_type):
    prompt = f"Generate test inputs to check for {vulnerability_type} vulnerabilities in web applications."
    response = client.completions.create(
        model="claude-2.1",
        prompt=f"Human: You are an expert in generating test inputs for security testing. {prompt}\n\nAssistant:",
        max_tokens_to_sample=150,
        temperature=0.7
    )
    return response.completion

def generate_report(findings):
    prompt = f"Summarize the following security findings in a professional report:\n\n{findings}"
    response = client.completions.create(
        model="claude-2.1",
        prompt=f"Human: You are a technical writer skilled in creating security reports. {prompt}\n\nAssistant:",
        max_tokens_to_sample=300,
        temperature=0
    )
    return response.completion


def test_url(url):
    try:
        response = requests.get(url)
        response.raise_for_status()  # Raises an HTTPError for bad responses

        if response.status_code == 200:
            # Analyze the content of the response
            content = response.text
            security_analysis = analyze_code(content)
            return security_analysis
        else:
            return f"Unexpected status code: {response.status_code}"
    except requests.RequestException as e:
        return f"Error occurred while fetching the URL: {str(e)}"


if __name__ == '__main__':
    url = "https://www.gatewayfoundation.org"
    security_analysis = test_url(url)
    print(security_analysis)